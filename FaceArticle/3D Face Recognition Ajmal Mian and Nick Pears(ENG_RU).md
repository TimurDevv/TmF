Абстрактное распознавание лиц с использованием стандартных 2D-изображений с трудом справляется с изменения освещения и позы. Алгоритмы 3D-распознавания лиц стали более успешно справляются с этими задачами. Трехмерные данные формы лица используются в качестве независимой подсказки для распознавания лиц, а также объединяются с текстурой для облегчения мультимодального распознавания лиц. Кроме того, были использованы 3D-модели лица.
для коррекции позы и расчета карты рассеяного цвета, которая инвариантна к освещениею. Наконец, трехмерное распознавание лиц также достигло значительного успеха в отношении инвариантности выражения лица за счет моделирования деформаций нежесткой поверхности, удаления выражения лица или с помощью распознавания лиц по частям. В этой главе дается обзор трехмерного распознавания лиц и подробностей, как хорошо зарекомендовавших себя, так и более поздних самые современные методы 3D-распознавания лиц с точки зрения их реализации и ожидаемая производительность на эталонных наборах данных.

8.1 Введение
Измерение внутренних характеристик человеческого лица является социально приемлемым биометрическим методом, который может быть реализован неинтрузивным способом [91]. Распознавание лиц на 2D-изображениях широко изучалось более четырех десятилетий [74]. Тем не менее, за последнее десятилетие было много исследований и публикаций в СМИ в области 3D-распознавания лиц. С ростом доступности доступных 3D-сканеров исследователи предложили множество алгоритмов и организовали ряд конкурсов для оценки их производительности. Некоторые коммерческие продукты также появились на рынке, и теперь можно приобрести ряд коммерческих готовых (COTS) систем трехмерного распознавания лиц. В этой главе будут представлены основные концепции, лежащие в основе алгоритмов распознавания лиц в 3D, дан обзор литературы и подробно рассмотрены некоторые тщательно отобранные репрезентативные и основополагающие методы. Обратите внимание, что мы не собираемся давать исчерпывающий обзор литературы из-за размера поля и учебного характера этого текста.

2D-изображение является функцией геометрии сцены, геометрии изображения, сцены. коэффициент отражения и условия освещения. Одна и та же сцена выглядит совершенно по-разному с разных точек зрения или при разном освещении. Для изображений человеческих лиц известно, что вариации из-за изменения позы и освещения больше, чем различия между изображениями разных предметов в одной и той же позе и условия освещения [1]. Поэтому алгоритмы распознавания лиц на основе 2D-изображений обычно с трудом справляются с такими вариациями изображений. С другой стороны, 3D-сканирование («3D-изображение») гораздо более прямо представляет геометрия просматриваемой сцены и гораздо меньше зависит от окружающего освещения и точка обзора (или, что то же самое, поза лица). Таким образом, 3D-распознавание лиц алгоритмы более успешно справляются с задачами различных Освещение и поза.
Строго говоря, однако, мы наблюдаем, что трехмерное изображение не полностью независимо от позы, потому что при съемке с помощью одной 3D-камеры с ее ограниченным полем зрения часть
изображенного лица явно зависит от позы. Другими словами, самоокклюзия – это проблема, а также исследовательские вопросы, касающиеся того факта, что 3D-вид поверхности является частичным
вступают в игру. Кроме того, 3D-камеры имеют некоторую чувствительность к сильным окружающим условиям.
освещение, так как в случае активной визуализации труднее обнаружить проецируемый свет шаблон, что иногда приводит к отсутствию частей в 3D-изображении. Дизайнеры фотоаппаратов часто
попытаться противостоять этому с помощью оптических фильтров и схем модулированного света. Наконец, при изменении позы ориентация отображаемой поверхности влияет на след объекта.
проецируемый свет и сколько света отражается обратно в камеру. Это варьируется количество шума на измеряемой геометрии поверхности.
Несмотря на эти проблемы, 3D-визуализация для распознавания лиц по-прежнему дает очевидные преимущества над 2D изображением. 3D-изображения используются как в качестве независимой подсказки для распознавания лиц, в мультимодальных схемах распознавания 2D/3D [34] [9], так и для помощи (корректировка позы) Распознавание лиц на основе 2D-изображения. Последние два варианта возможны, потому что большинство 3D-камер также захватывают цветную текстуру в виде стандартного 2D-изображения вместе с 3D форма, и регистрируются данные этих двух модальностей (2D и 3D). Разработки в области распознавания лиц в 3D также достигли значительных успехов в надежная работа при наличии вариаций выражения лица. Это достигается либо построением инвариантных к выражению представлений поверхности лица [87], либо моделированием нежестких деформаций поверхности [92], либо избеганием деформаций выражения с помощью только с учетом более жестких верхних частей лица [9] или областей вокруг
нос [51].

Данные 3D-сканеров можно использовать для создания 3D-моделей лица в автономном режиме, а для онлайн-распознавания используются стандартные датчики 2D-изображений, что устраняет необходимость в 3D-сканере. 8 3D-распознавание лиц 3 сканер в живой системе. Трехмерные модели лица использовались для оценки инвариантной к  карты рассеяного цвета. Как только будут доступны 3D-модель и карта рассеяного цвета, любое новое изображение может быть синтетически воспроизведено в новых позах и освещении условия. Используется большое количество таких изображений при разном освещении. построить конусы освещения лица [84], которые впоследствии используются для инвариантного к освещению распознавания лиц. Точно так же синтезированные изображения под разными позы используются для выборки пространства поз человеческих лиц и для обучения классификаторов для инвариантное распознавание лиц [84]. В другом подходе этого общего типа Бланз и Веттер [85] построили статистическую трансформируемую модель, которая обучается в автономном режиме от набор текстурированных 3D-сканов головы, полученных с помощью лазерного сканера. Данную модель можно установить /////изображениям с одного зонда, а параметры модели формы и текстуры используются для изображать и узнавать лица. Таким образом, существует множество различных возможностей при использовании 3D-сканирования лица на лице. системы распознавания. Хотя мы рассматриваем некоторые из них, основное внимание глава посвящена распознаванию только по данным 3D-формы, где геометрические элементы извлекаются из 3D-грани и сопоставляются с набором данных для определения идентичности неизвестному субъекту или для проверки заявленной им личности. Даже в этих 3D лицевых
систем распознавания формы, в литературе существует множество различных подходов, которые можно классифицировать по нескольким различным признакам. Одной из основных классификаций является
использование целостных представлений лица или представлений лица на основе признаков. целостный методы кодируют всю видимую поверхность лица после того, как его поза была нормализована (к
каноническая фронтальная поза), а поверхность и ее свойства передискретизируются для получения вектор признаков стандартного размера. Вектор признаков может содержать необработанные значения глубины и/или любую комбинацию свойств поверхности, таких как градиенты и кривизна. Этот подход был использован, например, с использованием карт глубины и связанных с ними карты объектов поверхности в схемах ближайших соседей в подпространствах, производных как от анализа главных компонентов (PCA), так и от линейного дискриминантного анализа (LDA) [38]. (Обратите внимание, что аналог этих методов для 2D-изображений часто называют
методы, основанные на внешнем виде, поскольку их низкоразмерное представление является точным к исходному изображению.)
Хотя холистические методы часто извлекают признаки, например, для локализации тройка реперных точек (ориентиров) для нормализации позы и вектор признаков (например, глубин, нормалей, кривизны и т. д.) извлекается для сопоставления 3D-лиц, термин метод, основанный на признаках, обычно относится к тем методам, которые кодируют только черты лица. поверхность вокруг извлеченных точек интереса, также называемых ключевыми точками. Например, это могут быть локальные экстремумы кривизны на лицевой поверхности или ключевые точки для мы узнали их местные свойства. Затем можно использовать подходы структурного сопоставления (например, сопоставления графов), когда относительные пространственные отношения признаков является ключом к процессу сопоставления лиц [71]. В качестве альтернативы подход «набор функций» можно было бы использовать там, где пространственные отношения полностью отброшены, а содержание более сложных «информационных» функций является ключом к процессу сопоставления лиц. Преимущество холистических методов заключается в том, что они пытаются использовать все видимые черты лица. поверхность для дискриминации. Однако, когда 3D-сканы зашумлены или имеют низкое разрешение, точная и надежная нормализация позы сложна, а подходы основаны на признаках может работать лучше.

Краткое описание основных этапов типичной системы трехмерного распознавания лиц.
являются следующими:
1. Получение 3D-сканирования лица. Трехмерное изображение лица получается с использованием одного из методов, описанных в главе 2 (пассивные методы) или в главе 3 (активные методы). В настоящее время большинство камер, используемых для 3D-распознавания лиц, активны из-за отсутствие достаточно крупномасштабной текстуры на поверхности лица большинства субъектов.
2. Предварительная обработка 3D-скана лица. В отличие от 2D-изображений с цифровой камеры, 3D-изображения изображение явно несовершенно и обычно содержит всплески, отсутствующие данные и значительный поверхностный шум. Эти аномалии удаляются во время предварительной обработки и любых
небольшие отверстия, как в исходном скане, так и в результате удаления данных шипы и ямки (отрицательные шипы) заполняются некоторой формой поверхностной интерполяции. процесс. Сглаживание поверхности, например, с помощью Гаусса, часто выполняется как заключительный этап предварительной обработки 3D-скана.
3. Локализация опорной точки и нормализация позы. Целостные подходы к распознаванию лиц требуют нормализации позы, чтобы при создании вектора признаков определенные части вектора признаков представляют свойства определенных частей лицевая поверхность. Как правило, это можно сделать, локализовав набор из трех реперных точки (например, внутренние уголки глаз и кончик носа), отображая их в каноническую рамку, а затем уточняя позу, регистрируя жесткую верхнюю область лица. к трехмерному шаблону лица в канонической позе, используя вариант итеративных ближайших точек (ICP) [15]. Обратите внимание, что многие основанные на функциях методы избегают этого. представляют стадию нормализации, так как в сложных сценариях часто трудно получить достаточно точная нормировка.
4. Извлечение вектора признаков. Набор функций извлекается из улучшенного 3D сканирование. Эти функции представляют собой геометрию лица, а не внешний вид двухмерной цветной текстуры. Выбор извлеченных функций имеет решающее значение для производительности системы и часто является компромиссом между свойствами инвариантности и богатством. информации, необходимой для дискриминации. Примеры «функций» включают необработанные сами значения глубины, нормали, кривизны, спиновые изображения [67], 3D адаптации дескриптора Scale-Invariant Feature Transform (SIFT) [79] и многие другие.
5. Сопоставление/классификация векторов черт лица. Последний шаг сопоставления/классификации признаков аналогичен любой другой проблеме классификации шаблонов, и в большинстве случаев
если не все, известные методы классификации были применены к 3D
распознавание лица. Примеры включают k-ближайших соседей (k-NN) в различных подпространствах, таких как производные от PCA и LDA, нейронных сетей, опорных векторов.
Машины (SVM), Adaboost и многие другие.

8.1.1 Chapter outline
![[Pasted image 20221101191510.png]]
An example range image. Brighter pixels are closer to the 3D camera

содержится. Раздел 8.3 дает обзор наборов данных, которые использовали исследователи. провести сравнительную оценку эффективности. В следующем разделе представлены типы оценки эффективности, которые производятся как для проверки, так и для признания. В разделе 8.5 рассматривается типичный конвейер обработки для трехмерного распознавания лиц. система и включает в себя обнаружение лиц, удаление шипов, заполнение отверстий, сглаживание, коррекцию позы, повторную выборку, извлечение признаков и классификацию. Разделы с 8.6 по 8.9 дают
обучающая презентация набора хорошо зарекомендовавших себя методов трехмерного распознавания лиц, включая ICP, целостные методы на основе подпространства (PCA, LDA) и методы на основе кривизны методы. В разделе 8.10 представлены самые современные подходы, в том числе аннотированные модели лица, методы, основанные на локальных функциях, и 3D-инвариантность, не зависящая от выражений. распознавание лица. Ближе к концу главы мы представляем будущие задачи для 3D-системы распознавания лиц, выводы, рекомендуемая дополнительная литература и вопросы
и упражнения для чтеца.

3D face scan representation and visualization

Основным измерением, предоставляемым большинством 3D-камер, является набор 3D-точек. координаты, pi = [Xi, Yi, Zi]Т , описанный в некотором определенном кадре 3D-камеры. С тех пор, как мы связаны с формой, закодированной относительной глубиной точек, а не абсолютной глубины знание точного определения этой рамки обычно не имеет значения. Если множество точек неупорядочено, оно называется облаком точек и не имеет соседства или информация о связности поверхности, явная или неявная в представлении.
Напротив, может быть сгенерировано изображение диапазона (см. рис. 8.1), которое представляет собой двумерное расположение значений глубины (координаты Z) сцены, соответствующих пикселям.
плоскости изображения 3D-сенсора. Изображение диапазона сохраняет только координаты Z воспринятых точек и соответствующие (X, Y) координаты могут быть получены из (калиброванные) параметры модели камеры. Можно преобразовать облако точек представление в центрально проецируемом изображении диапазона или ортогонально проецируемой глубине карта, которая похожа на изображение диапазона, но передискретизирована с ортогональной проекцией.
Поскольку в изображении диапазона сохраняется только диапазон, обратное также возможно, только если дана модель камеры (т. е. проекционная модель), так что правильные координаты (X, Y) могут быть вычислены для каждого пикселя изображения диапазона.

![[Pasted image 20221101192639.png]]

A 3D face mesh (rendered as flat shaded view in MeshLab [8]) is decimated three times using the quadric error algorithm [6].

Программное обеспечение многих стереофонических 3D-камер дополняет данные 3D-точек информацией о соединении поверхностей и, таким образом, предоставляет пользователю полигональную сетку (например, в формате OBJ). Это делает сканирование объекта более подходящим для целей рендеринга и обработки. Представления сетки распространены в компьютерной графике и генерируются путем построения многоугольников из соседних точек таким образом, что
каждый многоугольник плоский и простой (т.е. имеет непересекающиеся ребра). Оба эти ограничения всегда удовлетворяются треугольниками, поэтому большинство сеток состоит из только треугольники. Триангуляция Делоне — распространенный метод, используемый для создания треугольных сеток из облаков точек.

Датчики диапазона измеряют поверхность в соответствии с их относительной ориентацией и видом в перспективе датчика. Следовательно, поверхности, расположенные ближе и ортогональные к
датчик измеряется более плотно по сравнению с поверхностями, которые находятся далеко или наклонно к датчик. Для эффективного использования памяти и рендеринга точки/вершины из передискретизированных частей сцены удаляются с помощью прореживания сетки [5]. Прореживание сетки работает по принципу схлопывания ребер, что минимально изменяет геометрию поверхности, поэтому прореженная сетка содержит только часть точек/полигонов.
и при этом сохраняет исходную трехмерную форму. На рис. 8.2 показан образец трехмерного лица, прореженного три раза с использованием алгоритма квадратичной ошибки [6].
Полигональные модели представляют собой линейные аппроксимации поверхностей плоскими многоугольниками. А более точное математическое представление дают неравномерные рациональные B-сплайны (NURBS). Помимо большей точности, NURBS-представление
также является более компактным по сравнению с полигональным представлением. NURBS представляют поверхностей непрерывно в двух параметрических направлениях с помощью контрольных точек
и узлы. Подробности NURBS и B-сплайнов можно найти в [7].

Для рендеринга и обработки 3D-данных доступно большое количество инструментов визуализации. Большинство из них построены с использованием Open Graphics Library (OpenGL) и может отображать облака точек, сетки, заполненные полигоны с постоянным затенением или текстурой сопоставления. Точно так же существует множество форматов файлов, однако все они следуют одному и тому же
соглашение, то есть заголовок, за которым следуют координаты X, Y, Z облака точек и список полигонов. Заголовок обычно содержит информацию о сенсоре, параметрах рендеринга, количестве точек и полигонов и так далее. Список полигонов содержит порядковые номера точек, образующих многоугольник. Несколько примеров бесплатных инструментов визуализации и манипулирования: MeshLab [8], Plyview, Blender и Scanalyze.

Запатентованное программное обеспечение включает Maya, Rhino и Poser. Онлайн-наборы данных 3D-лиц
также растут, и наиболее известные из них обсуждаются в следующем разделе.

8.3 3D-наборы данных о лицах
Исследовательское сообщество использовало ряд наборов данных 3D-лиц для
3D-распознавание лиц и оценка проверки. Примеры с большим количеством
(> 1000) изображений включают
• Набор данных Face Recognition Grand Challenge v2 3D (FRGC v2) [19].
• Набор данных лица Bosphorus 3D (Bosphorus) [25].
• Набор данных распознавания лиц Texas 3D (Texas3DFRD) [27].
• Набор данных лиц Нотр-Дам 3D (ND-2006) [22].
• Набор трехмерных данных выражения лица Бингемтонского университета (BU-3DFE) [21].
• Набор 3D-данных Китайской академии наук Института автоматизации (CASIA)
[23].
• Набор трехмерных данных о лицах Йоркского университета (York3DFD) [38].
Наборы данных характеризуются количеством захваченных 3D-изображений, количеством
отображаемые объекты, качество и разрешение изображений, а также вариации позы лица, выражения и окклюзии. В таблице 8.1 приведена эта характеристика для
наборы данных, упомянутые выше.
![[Pasted image 20221107201719.png]]
Table 8.1 A selection of 3D face datasets used for face recognition evaluation.
Несколько сотен испытуемых с несколькими тысячами изображений позволяют исследователям наблюдать относительно небольшие различия в производительности статистически значимым образом.
Разные наборы данных более или менее подходят для оценки разных типов лица.
сценарий узнавания. Например, набор данных с нейтральным выражением лица, вид спереди, подходит для оценки «проверки кооперативного субъекта», но набор данных с позой
вариации, вариации выражения и окклюзия головными уборами (такими как шляпа и
очков) необходим для оценки типичного сценария «идентификации на расстоянии» для несотрудничающих субъектов, которые могут даже не подозревать, что их проверяют.
![[Pasted image 20221107201858.png]]
Рис. 8.3. Верхний ряд: 2D-изображения из набора данных FRGC v2. Вторая строка: визуализация соответствующих 3D-данных (после конвертации из формата ABS в формат OBJ).изображение. Этот тип набора данных сложнее собрать, так как необходимо охватить все распространенные комбинации вариантов, что приводит к гораздо большему количеству 3D-моделей. изображений по теме. Из-за нехватки места мы опишем только самые влиятельные из них, Набор данных FRGC v2 3D Face и набор данных Bosphorus. Читатель обращается к ссылки на литературу для получения подробной информации о других наборах данных.

## 8.3.1 Набор 3D-данных лица

За последние пять лет Гранд-вызов по распознаванию лиц версии 2
(FRGC v2) 3D-набор данных о лицах [19] был наиболее широко используемым набором данных в бенчмарке. идентификация лица и оценка проверки. Многие исследователи используют этот набор данных потому что это позволяет им сравнивать производительность своего алгоритма со многими другие. Действительно, в исследовательском сообществе стало почти ожидаемым, что оценки распознавания лиц будут включать использование этого набора данных, по крайней мере, для сценария проверки сотрудничающего субъекта.
Набор данных FRGC v2 содержит набор 3D-данных из 4950 3D-изображений, где каждое
Трехмерное изображение содержит два канала информации: структурированное трехмерное облако точек 1 а также зарегистрированное цветно-текстурное изображение (т. е. стандартное 2D-изображение). Пример того и другого эти каналы информации, каждый из которых имеет разрешение 640x480, показаны на Рис. 8.3. Таким образом, в дополнение к 3D распознаванию лиц, мультимодальное 2D/3D распознавание поддерживается. Результаты сравнения 2D, 3D и мультимодального распознавания на основе PCA по этому набору данных приведены в [34]. Существует прямое соответствие между 3D точек в данных диапазона 640x480 (формат abs) и пикселей в изображении цветового текстуры 640x480 (формат ppm). Файл данных диапазона представляет собой текстовый файл ASCII, содержащий некоторую заголовочную информацию, массив двоичных флагов размером 640x480, указывающий на то, где было сделано правильное и кортежи (X,Y,Z) в массиве 640x480. Там, где флаг диапазона считается недопустимым, каждое значение в кортеже устанавливается в -999999.0.

`1 3D-точки структурированы в виде прямоугольного массива, и поскольку значения (x,y) включены, это строго не изображение диапазона, которое содержит только z-значения`

Используемый  датчик дальности собирает данные о текстуре сразу после данных о дальности. Это открывает возможность того, что объект может слегка сдвинуть лицо между двумя этими съемками и может привести к плохой регистрации между каналами дальности и текстуры. Часто канал текстуры используется для разметки фидуциальных точек на лице, таких как уголки глаз, кончик носа и уголки рта. уголки глаз, кончик носа и уголки рта, которые затем отображаются на данные диапазона используя известную неявную регистрацию для получения трехмерных ориентиров. В этом случае, а также в других
случаях, когда важна регистрация канала, эти 3D-сканы должны быть  удалены. 

Ключевым моментом в правильной оценке любой системы контролируемого обучения является то, что различия между тренировочными и тестовыми 3D-сканами лица должны быть сопоставимы с тем, что ожидается при сборе тестовых данных в реальном оперативном сценарии распознавания. сценарии. При разработке набора данных получение последовательных сканов одного и того же лица приводит к тому, что данные тренировки/тестирования слишком похожи для правильной оценки, поэтому разные периоды сбора набора данных FRGC v2, который разделен на три части, Весна-2003, Осень-2003 и Весна-2004, названные в честь периодов их сбора. Набор данных Spring-2003 рассматривается Филлипсом и др. [19] как обучающий набор. Он состоит 943 трехмерных изображений, на которых субъекты находятся в сотрудничающей, почти фронтальной позе и с нейтральным выражением лица. Большинство изображений в этом подмножестве имеют такую глубину, что шеи и плеч. Однако меньшее количество содержит снимки крупным планом, где изображена только область лица. Таким образом, разрешение изображений
черты лица выше в этих сканах. Кроме того, в этом подмножестве для обучения контролируется окружающее контролируется освещение.

В наборах данных осень-2003 и весна-2004 окружающее освещение не контролируется, и
выражения лица разнообразны. Выражения включают гнев, счастье, грусть,
удивление, отвращение и "надутые щеки", хотя многие субъекты не сканировались с
хотя многие субъекты не сканируются с полным набором этих выражений. Кроме того, вариации глубины меньше, чем в подмножества Spring-2003, и все изображения являются крупными планами с небольшой площадью плеч. запечатлены. Позу снова можно считать фронтальной и совместной, но есть некоторые незначительные вариации позы. В этих подмножествах данных имеется 4007 двухканальных сканов 466 субъектов (1-22 скана на субъект), и Филлипс и др. [19] рассматривают их как проверочные наборы данных.

![[Pasted image 20221107204245.png]]
Fig. 8.4 Example 3D scans from the Bosphorus dataset with occlusions, expression variations and pose variations.

## Набор данных Босфора

Набор данных Bosphorus содержит 4666 3D изображений лиц 105 испытуемых, с 29-54 3D образцов изображений на одного испытуемого [25][26]. Таким образом, по сравнению с FRGC v2, здесь меньше испытуемых, но больше изображений на одного испытуемого, что позволяет использовать более широкое разнообразие естественных, неограниченных условий просмотра, связанных с некооперативным захватом изображений, можно исследовать. Существует три типа вариаций: выражение лица, поза и окклюзия. Включен стандартный набор из 6 выражений, в который входят счастье, удивление, страх, гнев, печаль и отвращение, но они дополнены набором более примитивных выражений, основанных на единицах лицевого действия (FACS), что дает в общей сложности 34 выражения.
Существует 14 различных поз (с нейтральным выражением), включающих 8 углов рысканья, 4 угла наклона и два комбинированных выражения. углы наклона и два комбинированных поворота примерно на 45 градусов по рысканию и ±20 градусов по рысканию и ±20 градусов по тангажу. Наконец, есть до 4 сканов с окклюзиями, включая руку над глаз, рука над ртом, очки и волосы над лицом.

Данные снимаются с помощью 3D-камеры Inspeck Mega Capturor II. Субъекты сидят
на расстоянии около 1,5 м от камеры и разрешение (X, Y, Z) составляет 0,3 мм, 0,3 мм, 0,4 мм
для каждого из этих измерений соответственно. Связанные изображения цвета-текстуры
1600x1200 пикселей. Примеры снимков из набора данных Босфор, которые хранятся
в виде структурированных карт глубины показаны на рис. 8.4. Регистрация в ассоциированном 2D-изображение хранится в виде двух массивов текстурных координат. Подробнее о захвате условия можно найти в [26].






