Абстрактное распознавание лиц с использованием стандартных 2D-изображений с трудом справляется с изменения освещения и позы. Алгоритмы 3D-распознавания лиц стали более успешно справляются с этими задачами. Трехмерные данные формы лица используются в качестве независимой подсказки для распознавания лиц, а также объединяются с текстурой для облегчения мультимодального распознавания лиц. Кроме того, были использованы 3D-модели лица.
для коррекции позы и расчета карты рассеяного цвета, которая инвариантна к освещениею. Наконец, трехмерное распознавание лиц также достигло значительного успеха в отношении инвариантности выражения лица за счет моделирования деформаций нежесткой поверхности, удаления выражения лица или с помощью распознавания лиц по частям. В этой главе дается обзор трехмерного распознавания лиц и подробностей, как хорошо зарекомендовавших себя, так и более поздних самые современные методы 3D-распознавания лиц с точки зрения их реализации и ожидаемая производительность на эталонных наборах данных.

8.1 Введение
Измерение внутренних характеристик человеческого лица является социально приемлемым биометрическим методом, который может быть реализован неинтрузивным способом [91]. Распознавание лиц на 2D-изображениях широко изучалось более четырех десятилетий [74]. Тем не менее, за последнее десятилетие было много исследований и публикаций в СМИ в области 3D-распознавания лиц. С ростом доступности доступных 3D-сканеров исследователи предложили множество алгоритмов и организовали ряд конкурсов для оценки их производительности. Некоторые коммерческие продукты также появились на рынке, и теперь можно приобрести ряд коммерческих готовых (COTS) систем трехмерного распознавания лиц. В этой главе будут представлены основные концепции, лежащие в основе алгоритмов распознавания лиц в 3D, дан обзор литературы и подробно рассмотрены некоторые тщательно отобранные репрезентативные и основополагающие методы. Обратите внимание, что мы не собираемся давать исчерпывающий обзор литературы из-за размера поля и учебного характера этого текста.

2D-изображение является функцией геометрии сцены, геометрии изображения, сцены. коэффициент отражения и условия освещения. Одна и та же сцена выглядит совершенно по-разному с разных точек зрения или при разном освещении. Для изображений человеческих лиц известно, что вариации из-за изменения позы и освещения больше, чем различия между изображениями разных предметов в одной и той же позе и условия освещения [1]. Поэтому алгоритмы распознавания лиц на основе 2D-изображений обычно с трудом справляются с такими вариациями изображений. С другой стороны, 3D-сканирование («3D-изображение») гораздо более прямо представляет геометрия просматриваемой сцены и гораздо меньше зависит от окружающего освещения и точка обзора (или, что то же самое, поза лица). Таким образом, 3D-распознавание лиц алгоритмы более успешно справляются с задачами различных Освещение и поза.
Строго говоря, однако, мы наблюдаем, что трехмерное изображение не полностью независимо от позы, потому что при съемке с помощью одной 3D-камеры с ее ограниченным полем зрения часть
изображенного лица явно зависит от позы. Другими словами, самоокклюзия – это проблема, а также исследовательские вопросы, касающиеся того факта, что 3D-вид поверхности является частичным
вступают в игру. Кроме того, 3D-камеры имеют некоторую чувствительность к сильным окружающим условиям.
освещение, так как в случае активной визуализации труднее обнаружить проецируемый свет шаблон, что иногда приводит к отсутствию частей в 3D-изображении. Дизайнеры фотоаппаратов часто
попытаться противостоять этому с помощью оптических фильтров и схем модулированного света. Наконец, при изменении позы ориентация отображаемой поверхности влияет на след объекта.
проецируемый свет и сколько света отражается обратно в камеру. Это варьируется количество шума на измеряемой геометрии поверхности.
Несмотря на эти проблемы, 3D-визуализация для распознавания лиц по-прежнему дает очевидные преимущества над 2D изображением. 3D-изображения используются как в качестве независимой подсказки для распознавания лиц, в мультимодальных схемах распознавания 2D/3D [34] [9], так и для помощи (корректировка позы) Распознавание лиц на основе 2D-изображения. Последние два варианта возможны, потому что большинство 3D-камер также захватывают цветную текстуру в виде стандартного 2D-изображения вместе с 3D форма, и регистрируются данные этих двух модальностей (2D и 3D). Разработки в области распознавания лиц в 3D также достигли значительных успехов в надежная работа при наличии вариаций выражения лица. Это достигается либо построением инвариантных к выражению представлений поверхности лица [87], либо моделированием нежестких деформаций поверхности [92], либо избеганием деформаций выражения с помощью только с учетом более жестких верхних частей лица [9] или областей вокруг
нос [51].

Данные 3D-сканеров можно использовать для создания 3D-моделей лица в автономном режиме, а для онлайн-распознавания используются стандартные датчики 2D-изображений, что устраняет необходимость в 3D-сканере. 8 3D-распознавание лиц 3 сканер в живой системе. Трехмерные модели лица использовались для оценки инвариантной к  карты рассеяного цвета. Как только будут доступны 3D-модель и карта рассеяного цвета, любое новое изображение может быть синтетически воспроизведено в новых позах и освещении условия. Используется большое количество таких изображений при разном освещении. построить конусы освещения лица [84], которые впоследствии используются для инвариантного к освещению распознавания лиц. Точно так же синтезированные изображения под разными позы используются для выборки пространства поз человеческих лиц и для обучения классификаторов для инвариантное распознавание лиц [84]. В другом подходе этого общего типа Бланз и Веттер [85] построили статистическую трансформируемую модель, которая обучается в автономном режиме от набор текстурированных 3D-сканов головы, полученных с помощью лазерного сканера. Данную модель можно установить /////изображениям с одного зонда, а параметры модели формы и текстуры используются для изображать и узнавать лица. Таким образом, существует множество различных возможностей при использовании 3D-сканирования лица на лице. системы распознавания. Хотя мы рассматриваем некоторые из них, основное внимание глава посвящена распознаванию только по данным 3D-формы, где геометрические элементы извлекаются из 3D-грани и сопоставляются с набором данных для определения идентичности неизвестному субъекту или для проверки заявленной им личности. Даже в этих 3D лицевых
систем распознавания формы, в литературе существует множество различных подходов, которые можно классифицировать по нескольким различным признакам. Одной из основных классификаций является
использование целостных представлений лица или представлений лица на основе признаков. целостный методы кодируют всю видимую поверхность лица после того, как его поза была нормализована (к
каноническая фронтальная поза), а поверхность и ее свойства передискретизируются для получения вектор признаков стандартного размера. Вектор признаков может содержать необработанные значения глубины и/или любую комбинацию свойств поверхности, таких как градиенты и кривизна. Этот подход был использован, например, с использованием карт глубины и связанных с ними карты объектов поверхности в схемах ближайших соседей в подпространствах, производных как от анализа главных компонентов (PCA), так и от линейного дискриминантного анализа (LDA) [38]. (Обратите внимание, что аналог этих методов для 2D-изображений часто называют
методы, основанные на внешнем виде, поскольку их низкоразмерное представление является точным к исходному изображению.)
Хотя холистические методы часто извлекают признаки, например, для локализации тройка реперных точек (ориентиров) для нормализации позы и вектор признаков (например, глубин, нормалей, кривизны и т. д.) извлекается для сопоставления 3D-лиц, термин метод, основанный на признаках, обычно относится к тем методам, которые кодируют только черты лица. поверхность вокруг извлеченных точек интереса, также называемых ключевыми точками. Например, это могут быть локальные экстремумы кривизны на лицевой поверхности или ключевые точки для мы узнали их местные свойства. Затем можно использовать подходы структурного сопоставления (например, сопоставления графов), когда относительные пространственные отношения признаков является ключом к процессу сопоставления лиц [71]. В качестве альтернативы подход «набор функций» можно было бы использовать там, где пространственные отношения полностью отброшены, а содержание более сложных «информационных» функций является ключом к процессу сопоставления лиц. Преимущество холистических методов заключается в том, что они пытаются использовать все видимые черты лица. поверхность для дискриминации. Однако, когда 3D-сканы зашумлены или имеют низкое разрешение, точная и надежная нормализация позы сложна, а подходы основаны на признаках может работать лучше.

Краткое описание основных этапов типичной системы трехмерного распознавания лиц.
являются следующими:
1. Получение 3D-сканирования лица. Трехмерное изображение лица получается с использованием одного из методов, описанных в главе 2 (пассивные методы) или в главе 3 (активные методы). В настоящее время большинство камер, используемых для 3D-распознавания лиц, активны из-за отсутствие достаточно крупномасштабной текстуры на поверхности лица большинства субъектов.
2. Предварительная обработка 3D-скана лица. В отличие от 2D-изображений с цифровой камеры, 3D-изображения изображение явно несовершенно и обычно содержит всплески, отсутствующие данные и значительный поверхностный шум. Эти аномалии удаляются во время предварительной обработки и любых
небольшие отверстия, как в исходном скане, так и в результате удаления данных шипы и ямки (отрицательные шипы) заполняются некоторой формой поверхностной интерполяции. процесс. Сглаживание поверхности, например, с помощью Гаусса, часто выполняется как заключительный этап предварительной обработки 3D-скана.
3. Локализация опорной точки и нормализация позы. Целостные подходы к распознаванию лиц требуют нормализации позы, чтобы при создании вектора признаков определенные части вектора признаков представляют свойства определенных частей лицевая поверхность. Как правило, это можно сделать, локализовав набор из трех реперных точки (например, внутренние уголки глаз и кончик носа), отображая их в каноническую рамку, а затем уточняя позу, регистрируя жесткую верхнюю область лица. к трехмерному шаблону лица в канонической позе, используя вариант итеративных ближайших точек (ICP) [15]. Обратите внимание, что многие основанные на функциях методы избегают этого. представляют стадию нормализации, так как в сложных сценариях часто трудно получить достаточно точная нормировка.
4. Извлечение вектора признаков. Набор функций извлекается из улучшенного 3D сканирование. Эти функции представляют собой геометрию лица, а не внешний вид двухмерной цветной текстуры. Выбор извлеченных функций имеет решающее значение для производительности системы и часто является компромиссом между свойствами инвариантности и богатством. информации, необходимой для дискриминации. Примеры «функций» включают необработанные сами значения глубины, нормали, кривизны, спиновые изображения [67], 3D адаптации дескриптора Scale-Invariant Feature Transform (SIFT) [79] и многие другие.
5. Сопоставление/классификация векторов черт лица. Последний шаг сопоставления/классификации признаков аналогичен любой другой проблеме классификации шаблонов, и в большинстве случаев
если не все, известные методы классификации были применены к 3D
распознавание лица. Примеры включают k-ближайших соседей (k-NN) в различных подпространствах, таких как производные от PCA и LDA, нейронных сетей, опорных векторов.
Машины (SVM), Adaboost и многие другие.

8.1.1 Chapter outline
![[Pasted image 20221101191510.png]]
An example range image. Brighter pixels are closer to the 3D camera

содержится. Раздел 8.3 дает обзор наборов данных, которые использовали исследователи. провести сравнительную оценку эффективности. В следующем разделе представлены типы оценки эффективности, которые производятся как для проверки, так и для признания. В разделе 8.5 рассматривается типичный конвейер обработки для трехмерного распознавания лиц. система и включает в себя обнаружение лиц, удаление шипов, заполнение отверстий, сглаживание, коррекцию позы, повторную выборку, извлечение признаков и классификацию. Разделы с 8.6 по 8.9 дают
обучающая презентация набора хорошо зарекомендовавших себя методов трехмерного распознавания лиц, включая ICP, целостные методы на основе подпространства (PCA, LDA) и методы на основе кривизны методы. В разделе 8.10 представлены самые современные подходы, в том числе аннотированные модели лица, методы, основанные на локальных функциях, и 3D-инвариантность, не зависящая от выражений. распознавание лица. Ближе к концу главы мы представляем будущие задачи для 3D-системы распознавания лиц, выводы, рекомендуемая дополнительная литература и вопросы
и упражнения для чтеца.

3D face scan representation and visualization

Основным измерением, предоставляемым большинством 3D-камер, является набор 3D-точек. координаты, pi = [Xi, Yi, Zi]Т , описанный в некотором определенном кадре 3D-камеры. С тех пор, как мы связаны с формой, закодированной относительной глубиной точек, а не абсолютной глубины знание точного определения этой рамки обычно не имеет значения. Если множество точек неупорядочено, оно называется облаком точек и не имеет соседства или информация о связности поверхности, явная или неявная в представлении.
Напротив, может быть сгенерировано изображение диапазона (см. рис. 8.1), которое представляет собой двумерное расположение значений глубины (координаты Z) сцены, соответствующих пикселям.
плоскости изображения 3D-сенсора. Изображение диапазона сохраняет только координаты Z воспринятых точек и соответствующие (X, Y) координаты могут быть получены из (калиброванные) параметры модели камеры. Можно преобразовать облако точек представление в центрально проецируемом изображении диапазона или ортогонально проецируемой глубине карта, которая похожа на изображение диапазона, но передискретизирована с ортогональной проекцией.
Поскольку в изображении диапазона сохраняется только диапазон, обратное также возможно, только если дана модель камеры (т. е. проекционная модель), так что правильные координаты (X, Y) могут быть вычислены для каждого пикселя изображения диапазона.

![[Pasted image 20221101192639.png]]

A 3D face mesh (rendered as flat shaded view in MeshLab [8]) is decimated three times using the quadric error algorithm [6].

Программное обеспечение многих стереофонических 3D-камер дополняет данные 3D-точек информацией о соединении поверхностей и, таким образом, предоставляет пользователю полигональную сетку (например, в формате OBJ). Это делает сканирование объекта более подходящим для целей рендеринга и обработки. Представления сетки распространены в компьютерной графике и генерируются путем построения многоугольников из соседних точек таким образом, что
каждый многоугольник плоский и простой (т.е. имеет непересекающиеся ребра). Оба эти ограничения всегда удовлетворяются треугольниками, поэтому большинство сеток состоит из только треугольники. Триангуляция Делоне — распространенный метод, используемый для создания треугольных сеток из облаков точек.

Датчики диапазона измеряют поверхность в соответствии с их относительной ориентацией и видом в перспективе датчика. Следовательно, поверхности, расположенные ближе и ортогональные к
датчик измеряется более плотно по сравнению с поверхностями, которые находятся далеко или наклонно к датчик. Для эффективного использования памяти и рендеринга точки/вершины из передискретизированных частей сцены удаляются с помощью прореживания сетки [5]. Прореживание сетки работает по принципу схлопывания ребер, что минимально изменяет геометрию поверхности, поэтому прореженная сетка содержит только часть точек/полигонов.
и при этом сохраняет исходную трехмерную форму. На рис. 8.2 показан образец трехмерного лица, прореженного три раза с использованием алгоритма квадратичной ошибки [6].
Полигональные модели представляют собой линейные аппроксимации поверхностей плоскими многоугольниками. А более точное математическое представление дают неравномерные рациональные B-сплайны (NURBS). Помимо большей точности, NURBS-представление
также является более компактным по сравнению с полигональным представлением. NURBS представляют поверхностей непрерывно в двух параметрических направлениях с помощью контрольных точек
и узлы. Подробности NURBS и B-сплайнов можно найти в [7].

Для рендеринга и обработки 3D-данных доступно большое количество инструментов визуализации. Большинство из них построены с использованием Open Graphics Library (OpenGL) и может отображать облака точек, сетки, заполненные полигоны с постоянным затенением или текстурой сопоставления. Точно так же существует множество форматов файлов, однако все они следуют одному и тому же
соглашение, то есть заголовок, за которым следуют координаты X, Y, Z облака точек и список полигонов. Заголовок обычно содержит информацию о сенсоре, параметрах рендеринга, количестве точек и полигонов и так далее. Список полигонов содержит порядковые номера точек, образующих многоугольник. Несколько примеров бесплатных инструментов визуализации и манипулирования: MeshLab [8], Plyview, Blender и Scanalyze.

Запатентованное программное обеспечение включает Maya, Rhino и Poser. Онлайн-наборы данных 3D-лиц
также растут, и наиболее известные из них обсуждаются в следующем разделе.

8.3 3D-наборы данных о лицах
Исследовательское сообщество использовало ряд наборов данных 3D-лиц для
3D-распознавание лиц и оценка проверки. Примеры с большим количеством
(> 1000) изображений включают
• Набор данных Face Recognition Grand Challenge v2 3D (FRGC v2) [19].
• Набор данных лица Bosphorus 3D (Bosphorus) [25].
• Набор данных распознавания лиц Texas 3D (Texas3DFRD) [27].
• Набор данных лиц Нотр-Дам 3D (ND-2006) [22].
• Набор трехмерных данных выражения лица Бингемтонского университета (BU-3DFE) [21].
• Набор 3D-данных Китайской академии наук Института автоматизации (CASIA)
[23].
• Набор трехмерных данных о лицах Йоркского университета (York3DFD) [38].
Наборы данных характеризуются количеством захваченных 3D-изображений, количеством
отображаемые объекты, качество и разрешение изображений, а также вариации позы лица, выражения и окклюзии. В таблице 8.1 приведена эта характеристика для
наборы данных, упомянутые выше.
![[Pasted image 20221107201719.png]]
Table 8.1 A selection of 3D face datasets used for face recognition evaluation.
Несколько сотен испытуемых с несколькими тысячами изображений позволяют исследователям наблюдать относительно небольшие различия в производительности статистически значимым образом.
Разные наборы данных более или менее подходят для оценки разных типов лица.
сценарий узнавания. Например, набор данных с нейтральным выражением лица, вид спереди, подходит для оценки «проверки кооперативного субъекта», но набор данных с позой
вариации, вариации выражения и окклюзия головными уборами (такими как шляпа и
очков) необходим для оценки типичного сценария «идентификации на расстоянии» для несотрудничающих субъектов, которые могут даже не подозревать, что их проверяют.
![[Pasted image 20221107201858.png]]
Рис. 8.3. Верхний ряд: 2D-изображения из набора данных FRGC v2. Вторая строка: визуализация соответствующих 3D-данных (после конвертации из формата ABS в формат OBJ).изображение. Этот тип набора данных сложнее собрать, так как необходимо охватить все распространенные комбинации вариантов, что приводит к гораздо большему количеству 3D-моделей. изображений по теме. Из-за нехватки места мы опишем только самые влиятельные из них, Набор данных FRGC v2 3D Face и набор данных Bosphorus. Читатель обращается к ссылки на литературу для получения подробной информации о других наборах данных.

## 8.3.1 Набор 3D-данных лица

За последние пять лет Гранд-вызов по распознаванию лиц версии 2
(FRGC v2) 3D-набор данных о лицах [19] был наиболее широко используемым набором данных в бенчмарке. идентификация лица и оценка проверки. Многие исследователи используют этот набор данных потому что это позволяет им сравнивать производительность своего алгоритма со многими другие. Действительно, в исследовательском сообществе стало почти ожидаемым, что оценки распознавания лиц будут включать использование этого набора данных, по крайней мере, для сценария проверки сотрудничающего субъекта.
Набор данных FRGC v2 содержит набор 3D-данных из 4950 3D-изображений, где каждое
Трехмерное изображение содержит два канала информации: структурированное трехмерное облако точек 1 а также зарегистрированное цветно-текстурное изображение (т. е. стандартное 2D-изображение). Пример того и другого эти каналы информации, каждый из которых имеет разрешение 640x480, показаны на Рис. 8.3. Таким образом, в дополнение к 3D распознаванию лиц, мультимодальное 2D/3D распознавание поддерживается. Результаты сравнения 2D, 3D и мультимодального распознавания на основе PCA по этому набору данных приведены в [34]. Существует прямое соответствие между 3D точек в данных диапазона 640x480 (формат abs) и пикселей в изображении цветового текстуры 640x480 (формат ppm). Файл данных диапазона представляет собой текстовый файл ASCII, содержащий некоторую заголовочную информацию, массив двоичных флагов размером 640x480, указывающий на то, где было сделано правильное и кортежи (X,Y,Z) в массиве 640x480. Там, где флаг диапазона считается недопустимым, каждое значение в кортеже устанавливается в -999999.0.

`1 3D-точки структурированы в виде прямоугольного массива, и поскольку значения (x,y) включены, это строго не изображение диапазона, которое содержит только z-значения`

Используемый  датчик дальности собирает данные о текстуре сразу после данных о дальности. Это открывает возможность того, что объект может слегка сдвинуть лицо между двумя этими съемками и может привести к плохой регистрации между каналами дальности и текстуры. Часто канал текстуры используется для разметки фидуциальных точек на лице, таких как уголки глаз, кончик носа и уголки рта. уголки глаз, кончик носа и уголки рта, которые затем отображаются на данные диапазона используя известную неявную регистрацию для получения трехмерных ориентиров. В этом случае, а также в других
случаях, когда важна регистрация канала, эти 3D-сканы должны быть  удалены. 

Ключевым моментом в правильной оценке любой системы контролируемого обучения является то, что различия между тренировочными и тестовыми 3D-сканами лица должны быть сопоставимы с тем, что ожидается при сборе тестовых данных в реальном оперативном сценарии распознавания. сценарии. При разработке набора данных получение последовательных сканов одного и того же лица приводит к тому, что данные тренировки/тестирования слишком похожи для правильной оценки, поэтому разные периоды сбора набора данных FRGC v2, который разделен на три части, Весна-2003, Осень-2003 и Весна-2004, названные в честь периодов их сбора. Набор данных Spring-2003 рассматривается Филлипсом и др. [19] как обучающий набор. Он состоит 943 трехмерных изображений, на которых субъекты находятся в сотрудничающей, почти фронтальной позе и с нейтральным выражением лица. Большинство изображений в этом подмножестве имеют такую глубину, что шеи и плеч. Однако меньшее количество содержит снимки крупным планом, где изображена только область лица. Таким образом, разрешение изображений
черты лица выше в этих сканах. Кроме того, в этом подмножестве для обучения контролируется окружающее контролируется освещение.

В наборах данных осень-2003 и весна-2004 окружающее освещение не контролируется, и
выражения лица разнообразны. Выражения включают гнев, счастье, грусть,
удивление, отвращение и "надутые щеки", хотя многие субъекты не сканировались с
хотя многие субъекты не сканируются с полным набором этих выражений. Кроме того, вариации глубины меньше, чем в подмножества Spring-2003, и все изображения являются крупными планами с небольшой площадью плеч. запечатлены. Позу снова можно считать фронтальной и совместной, но есть некоторые незначительные вариации позы. В этих подмножествах данных имеется 4007 двухканальных сканов 466 субъектов (1-22 скана на субъект), и Филлипс и др. [19] рассматривают их как проверочные наборы данных.

![[Pasted image 20221107204245.png]]
Fig. 8.4 Example 3D scans from the Bosphorus dataset with occlusions, expression variations and pose variations.

## Набор данных Босфора

Набор данных Bosphorus содержит 4666 3D изображений лиц 105 испытуемых, с 29-54 3D образцов изображений на одного испытуемого [25][26]. Таким образом, по сравнению с FRGC v2, здесь меньше испытуемых, но больше изображений на одного испытуемого, что позволяет использовать более широкое разнообразие естественных, неограниченных условий просмотра, связанных с некооперативным захватом изображений, можно исследовать. Существует три типа вариаций: выражение лица, поза и окклюзия. Включен стандартный набор из 6 выражений, в который входят счастье, удивление, страх, гнев, печаль и отвращение, но они дополнены набором более примитивных выражений, основанных на единицах лицевого действия (FACS), что дает в общей сложности 34 выражения.
Существует 14 различных поз (с нейтральным выражением), включающих 8 углов рысканья, 4 угла наклона и два комбинированных выражения. углы наклона и два комбинированных поворота примерно на 45 градусов по рысканию и ±20 градусов по рысканию и ±20 градусов по тангажу. Наконец, есть до 4 сканов с окклюзиями, включая руку над глаз, рука над ртом, очки и волосы над лицом.

Данные снимаются с помощью 3D-камеры Inspeck Mega Capturor II. Субъекты сидят
на расстоянии около 1,5 м от камеры и разрешение (X, Y, Z) составляет 0,3 мм, 0,3 мм, 0,4 мм
для каждого из этих измерений соответственно. Связанные изображения цвета-текстуры
1600x1200 пикселей. Примеры снимков из набора данных Босфор, которые хранятся
в виде структурированных карт глубины показаны на рис. 8.4. Регистрация в ассоциированном 2D-изображение хранится в виде двух массивов текстурных координат. Подробнее о захвате условия можно найти в [26].

##8.4 Оценка трехмерного распознавания лиц
Оценка системы трехмерного распознавания лиц зависит от приложения, для которого она предназначена, Как правило, система распознавания лиц работает либо в
приложение, требующее взаимно однозначного сопоставления, или приложение идентификации, который требует сопоставления один ко многим. Мы обсудим каждый из них по очереди в следующих подразделах.

## 8.4.1 Проверка лица

В приложении для проверки система распознавания лиц должна предоставить двоичное решение о принятии или отклонении в качестве ответа на заявленную личность субъекта, связанную с с одним из сохраненных наборов сканов галереи. Он делает это, генерируя счет матча между захваченным 3D-сканом (датчиком или запросом) и сканом(-ами) галереи
заявленная личность субъекта. Часто это реализуется как метрика расстояния между
векторы признаков, такие как евклидово расстояние, косинусное расстояние или расстояние Махаланобиса (в случае нескольких изображений одного и того же человека в галерее). низкий оценка по метрике расстояния указывает на близкое совпадение и применение подходящего порог генерирует решение о принятии/отклонении. В основном используются системы проверки уполномоченными лицами, которые хотят получить законный доступ к зданию или компьютерная система. Следовательно, они обычно будут сотрудничать при принятии нейтральное выражение лица и фронтальная поза на благоприятном расстоянии от камеры. Для совместных сценариев наборы данных, такие как FRGC v2, обеспечивают подходящее обучение и проверку. наборы данных для выполнения проверочных тестов.

Чтобы оценить систему верификации, необходимо провести большое количество верификационных тестов должно быть выполнено, когда личность субъекта, связанная с тестовым 3D-изображением, известны, чтобы можно было установить, было ли решение о принятии/отклонении правильным. Эту идентичность можно извлечь из имени файла 3D-изображения в наборе данных с помощью средства уникального идентификатора субъекта.

Ключевым моментом является то, что решение о принятии/отклонении зависит от порога и
желательно исследовать производительность системы в широком диапазоне таких порогов.
Учитывая, что доступен набор 3D-сканов лица, все с известными личностями, и есть
по крайней мере два сканирования каждого предмета, теперь мы опишем способ реализации этого. Каждое изображение в наборе сравнивается со всеми остальными, исключая себя, и формируется балл. Затем формируются два списка, один из которых содержит совпадения для одной и той же личности субъекта, а другой содержит совпадения для разных субъектов. Затем мы варьируем порог от нуля, чтобы все решения были отклонены, до максимального значения балла, так что все решения принимаются. Для каждого порогового значения мы рассматриваем два списка и подсчитайте количество решений об отклонении из одного и того же списка идентификаторов (SI), чтобы сформировать частота ложных отказов (FRR) в процентах от размера списка SI, и мы подсчитываем количество решений о принятии в списке различных идентификаторов (DI), чтобы сформировать ложное принятие скорость (FAR) в процентах от размера списка DI. В идеале должны быть и FAR, и FRR. и ноль, и это описывает идеальную производительность системы. Однако на самом деле системы проверки несовершенны, и существуют как ложные приемы, так и ложные отказы. ЛОЖЬ количество приемов может быть уменьшено за счет уменьшения порога, но это увеличивает количество ложных отказов наоборот. Рабочая характеристика приемника или кривая ROC, как определено в тестах биометрической проверки, представляет собой график FRR против FAR для всех порогов, что дает
визуализация компромисса между этими двумя показателями производительности. В зависимости от размера набора данных и количества сканирований на человека размеры списков SI и DI могут быть очень разными, причем DI обычно намного больше, чем SI. Это подразумевает, что значения на оси FRR более зашумлены, чем на оси FAR.

Чтобы измерить производительность системы с помощью кривой ROC, мы можем использовать концепцию равной частоты ошибок (EER), где FAR = FRR, а меньшее значение указывает is set at 0.001 (0.1%).

На момент написания статьи высокопроизводительные 3D-системы распознавания лиц сообщают о показателях проверки, которые обычно колеблются от 96,5% до 98,5% (к
ближайшие полпроцента) при 0,1% FAR в полном наборе данных FRGC v2 [60] [61] [9]. Этот
является значительным улучшением производительности примерно на 20% по сравнению с базовым уровнем на основе PCA результаты [62]. Разумно предположить, что во многих сценариях проверки субъект будет сотрудничать с нейтральным выражением лица. Скорость поверки датчиков с нейтральные выражения варьируются только от 98,5% до 99,5% [61] [9] при 0,1% FAR.

## 8.4.2 Индетификация лица.

При идентификации лица трехмерное изображение зонда (запроса) сопоставляется с сохраненной галереей изображений. Создается 3D-изображение с известными метками-идентификаторами и набор совпадающих оценок. Таким образом, идентификация требует процесса сопоставления «один ко многим», в отличие от верификации. матч один на один. Матч с наибольшим количеством очков (или, что то же самое, с наименьшим метрика расстояния) обеспечивает идентификацию зонда. Если ближайшее совпадение не близко
достаточно применить некоторый порог, система может вернуть нулевой ответ,
указывая на то, что зонд не соответствует ни одному предмету в галерее. это более
сложной задачей, чем проверка, так как, если в галерее 1000 предметов,
система должна дать правильный ответ из 1001 возможных ответов (включая
нулевой ответ).

Чтобы проверить, насколько хороша трехмерная система распознавания лиц при идентификации, выполняется ряд идентификационных тестов, при этом 3D-изображение не сравнивается с себя, и мы определяем процент правильных идентификаций. Это дает
коэффициент идентификации ранг-1, что означает, что совпадение принимается как лучшее (ранг-1) оценка достигается при сопоставлении с галереей. Однако мы можем представить реальный мир сценарии идентификации, в которых тест идентификации ранга 1 слишком суров и где нас может заинтересовать более широкий показатель производительности. Одним из таких сценариев являются часы список, в котором могут храниться 3D-изображения небольшого числа известных преступников. галерея, наряду с большим набором широкой публики. Если зонд соответствует разумно к любой из этих преступных личностей, так что счет матча ранжируется в первая десятка, то это может вызвать тревогу для ручной проверки изображения зонда и 10 лучших совпадений в галерее. В этом случае важна скорость идентификации 10-го ранга.
На практике кривые строятся путем записи ранга правильного совпадения и
затем подсчитывается процент идентификаций, которые меньше или равны r, где
r — допустимый ранг. Допустимый ранг начинается с 1 и увеличивается до 100%.
распознавание достигается для некоторого r, или граф может быть остановлен до этого, для
пример r = 100. Построение такой кривой кумулятивного соответствия (CMC) в процентах

![[Pasted image 20221108184144.png]]

``Блок-схема, показывающая типичные этапы обработки в системе трехмерного распознавания лиц. Где несколько возможных переупорядочений этого конвейера в зависимости от качества входных данных и приоритетов производительности приложения.

идентификация по рангу позволяет нам сравнивать системы в диапазоне возможных рабочих точек, хотя идентификация по рангу 1 является наиболее важной из них.

На момент написания статьи высокопроизводительные 3D-системы распознавания лиц сообщают о показателях идентификации первого ранга, которые обычно колеблются от 96% до 98,5% [60]. [61] [9] в наборе данных о лицах FRGC v2 3D. Отметим, что набор 3D-данных лиц FRGC v2 не содержит значительных вариаций позы, и производительность систем идентификации может снизиться по мере разработки более сложных крупномасштабных наборов данных, которые действительно содержат такие вариации.

## 8.5 Этапы обработки при 3D распознавании лиц

При разработке 3D-системы распознавания лиц необходимо понимать, какая информация поступает с камеры или из набора данных, в каком формате она представлена в каком формате она представлена и какие недостатки могут существовать. Необработанные данные, полученные даже от Даже самые точные сканеры несовершенны, поскольку содержат пики, дыры и шум. Этапы предварительной обработки обычно подбираются с учетом формы и качества этих исходных данных. Часто сканы лица должны быть нормализованы в отношении позы (например, целостные подходы) и пространственной выборки перед извлечением признаков для 3D-распознавания лиц. Хотя 3D конвейер обработки трехмерных лиц, показанный на рис. 8.5, является типичным, существует множество его вариаций; в частности, существует несколько возможных перестановок и не все этапы предварительной обработки и нормализация позы не всегда являются необходимыми. Исходя из этого понимания, мы обсудим все этапы конвейера в следующих подразделах.

## 8.5.1 Обнаружение и сегментация лиц

Изображения, полученные с помощью 3D-сенсора, обычно содержат большую площадь, чем просто область лица и часто желательно сегментировать и обрезать эти посторонние данные как можно раньше в конвейере обработки, чтобы ускорить обработку в последующих секциях трубопровода. Этот процесс обнаружения и обрезки лица позволяет получить трехмерное изображение лица. сегментация, может выполняться на основе данных 3D-дальности камеры, 2D-текстуры изображение или их сочетание. 

В случае 2D-изображений распознавание лиц является зрелой областью (особенно для фронтальных изображений позы), а популярные подходы включают обнаружение кожи, шаблоны лица, собственные лица, нейронные сети, машины опорных векторов и скрытые марковские модели. Обзор обнаружение лиц на изображениях дано Yang et al. [16]. Оригинальный подход к обнаружению лиц в реальном времени, предложенный Виолой и Джонсом [17], основан на вейвлетах Хаара и адаптивных алгоритмах.
повышение (Adaboost) и является частью библиотеки Open Computer Vision (OpenCV).

Однако некоторые системы распознавания лиц предпочитают не полагаться на существование двухмерного текстурного канала в данных 3D-камеры и обрезать лицо на основе только трехмерной информации. Также использование 3D информации иногда предпочтительнее для более точной локализации лица. Если сделать некоторые предположения о позе, то можно применить некоторые базовые техники. Например, можно взять самую верхнюю вершину (наибольшее значение y), предположить, что она находится рядом с макушкой головы, и обрезать на достаточном расстоянии вниз от этой точки.
достаточное расстояние вниз от этой точки, чтобы включить самые крупные лица, которые могут быть встретятся. Обратите внимание, что это может не сработать, если самая верхняя вершина находится на шляпе, другом шляпа, другой аксессуар на голове или некоторые виды причесок. В качестве альтернативы, для совместных объектовв фронтальных позах, можно сделать предположение, что кончик носа является самой близкой точкой к и обрезать сферическую область вокруг этой точки, чтобы сегментировать область лица.
Однако подбородок, лоб или волосы иногда оказываются ближе. Таким образом, особенно при в присутствии пиков глубины, такой подход может оказаться неудачным, и лучше перенести процесс обрезки дальше по конвейеру обработки, чтобы он был после этапа фильтрации всплесков фильтрации.

Если вычислительная мощность системы такова, что допустимо перемещение обрезки еще дальше по конвейеру, можно применить более сложные подходы к обрезке, которые могут быть основаны на локализации черт лица которые могут быть основаны на локализации черт лица и некоторых из методов, описанных ранее для двухмерного обнаружения лиц. Нос, возможно, является наиболее нос, пожалуй, самая заметная черта, которая использовалась отдельно [9] или в сочетании с внутренними уголками глаз для сегментации области лица [18]. Последний подход использует основные кривизны для обнаружения носа и глаз. Триплет кандидатов затем используется классификатор на основе РСА для обнаружения лица.

## 8.5.2 Удаление шипов

Шипы вызываются в основном спекулярными областями. В случае с лицами, глаза, нос
кончик носа и зубы являются тремя основными областями, где возможно появление пиков. Глазная линза иногда формирует реальное изображение перед лицом, вызывая положительный всплеск. Аналогично, зеркальное отражение от глаза формирует изображение лазера за глазом вызывая негативный всплеск. Блестящие зубы кажутся выпуклыми на 3D-сканировании, а небольшой шип может иногда образовываться на кончике носа. Глянцевый макияж лица или жирная кожа могут также вызывать всплески на других участках лица. В медицинских приложениях, таких как черепно-лицевая антропометрия, лицо припудривают, чтобы сделать его поверхность ламбертианской, и
зубы окрашиваются перед сканированием. Некоторые сканеры, такие как Swiss Ranger [4], также предоставляют карту достоверности вместе с диапазоном и полутоновым изображением. Удаление точек с низкой достоверностью, как правило, удаляет пики, но приводит к появлению больших областей отсутствующих данных, поскольку точки, которые не являются шипами, также могут быть удалены. Обнаружение шипов работает по принципу, что поверхности, и в частности лица, обычно гладкие.

Один простой подход к фильтрации пиков заключается в исследовании небольшой окрестности для каждой точки сетки или изображения диапазона и заменить ее глубину (значение Z-координаты) на медианой этой малой окрестности. Это стандартный медианный фильтр, который, хотя и эффективен, может ослабить тонкие детали поверхности. Другой подход заключается в определении порога абсолютной разницы между глубиной точки и медианой глубин ее соседей. Только если порог превышен, глубина точки заменяется на
медианой или удаляется для последующего заполнения более сложной схемой. Эти подходы хорошо работают в данных высокого разрешения, но в данных достаточно низкого разрешения проблемы могут возникнуть, если поверхность лица крутая относительно угла обзора, например, боковые стороны носа на фронтальных видах. В этом случае мы можем обнаружить пики относительно локальной ориентации поверхности, но для этого необходимо вычислить нормали поверхности вычисления нормалей поверхности, которые повреждаются шипами. Можно использовать итерационную процедуру, при которой нормали поверхности вычисляются, а шипы удаляются по циклам, что позволяет получить чистый, не испорченный набор нормалей поверхности даже для данных с относительно низким разрешением данных [83]. Хотя этот метод хорошо подходит для учебных данных, где время обработки не критично, он может оказаться вычислительно дорогим для текущих тестовых данных.

## 8.5.3 Заполнение пробелов и недостающие данные

Помимо дыр, образовавшихся в результате удаления шипов, 3D-данные содержат множество
других недостающих точек из-за окклюзий, например, нос закрывает щеку, когда, например, позиция головы достаточно сильно повернута (по углу рысканья) относительно 3D камеры. Очевидно, что такие участки сцены, которые не видны ни камере, ни проецируемого света, не могут быть получены. Аналогично, темные области, которые не отражают темные области, которые не отражают достаточного количества проецируемого света, не воспринимаются 3D-камерой. И то, и другое может привести к появлению больших области недостающих данных, которые часто называют недостающими частями.

В случае совместного применения (например, в типичном приложении для верификации) получаются фронтальные изображения лица, и окклюзия не является серьезной проблемой. Однако, темные области, такие как брови и волосы на лице, обычно не получают. Более того, при лазерной проекции нельзя увеличивать мощность для получения темных областей
лица по соображениям безопасности для глаз. 

Таким образом, единственным вариантом является заполнение недостающих областей с помощью метода интерполяции например, ближайшего соседа, линейной или полиномиальной. Для небольших отверстий линейная интерполяция дает приемлемые результаты, однако бикубическая интерполяция показала, что она дает лучшие результаты [9]. В качестве альтернативы можно использовать неявные представления поверхности для интерполяции, такие как радиальные базисные функции [83].

Для отверстий большего размера можно использовать подходы, основанные на симметрии или РСА, хотя они требуют локализованной плоскости симметрии и полного 6-DOF жесткого выравнивания соответственно, и, следовательно, должны быть перенесены дальше вниз в процессе обработки конвейера. В качестве альтернативы можно использовать подход, основанный на модели, чтобы изменить модель до тех пор. пока она не будет наилучшим образом соответствовать точкам данных [3]. Этот подход изучает трехмерное пространство лица в автономном режиме и требует значительного объема обучающих данных для обобщения на невидимые лица. Однако он может быть очень полезен, если сканируемое лицо было ранее замечено. и, очевидно, это распространенный сценарий в 3D распознавании лиц.

Для лучшего обобщения на невидимые лица используется антропометрически правильная [65] аннотированная модель лица (AFM) [61]. AFM основана на усредненном 3D лице
построенного с использованием статистических данных, а антропометрические ориентиры ассоциируются с его вершинами. AFM затем подгоняется к необработанным данным со сканера с использованием деформируемой модели. Бланц и др. [12] также использовали деформируемую модель для подгонки 3D-сканирования, заполняя недостающие области в дополнение к другим шагам предварительной обработки в единой системе.


